syntax = "proto3";
package rune.api;
option go_package = "github.com/rzbill/rune/pkg/api/generated";

// HTTP annotations are optional; omit to avoid dependency for now

message WhoAmIRequest {}
message WhoAmIResponse {
  string subject_id = 1;
  string subject_name = 2;  // User's display name
  string subject_email = 3; // User's email address
  repeated string policies = 4;
}

message CreateTokenRequest {
  string name = 1;
  string subject_id = 2;
  string subject_name = 3;
  string subject_type = 4; // user|service
  repeated string policies = 5; // repurposed to carry default policies on auto-create
  int64 ttl_seconds = 6; // 0 for no expiry
  string description = 7;
}
message CreateTokenResponse {
  string id = 1;
  string name = 2;
  string secret = 3; // returned once
}

message RevokeTokenRequest {
  string id = 1;
}
message RevokeTokenResponse {
  bool revoked = 1;
}

service AuthService {
  rpc WhoAmI(WhoAmIRequest) returns (WhoAmIResponse);
  rpc CreateToken(CreateTokenRequest) returns (CreateTokenResponse);
  rpc RevokeToken(RevokeTokenRequest) returns (RevokeTokenResponse);
}


